{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "ChannelStats"
    },
    "designerId": "95044814-d0fb-4353-9b22-0a720b6d5a9a",
    "cn": [
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "Launch",
                "implHandler": [
                    "MyApp.app.channStats={};  // Spike module",
                    "",
                    "MyApp.app.channStats.panelChartStats=this.getChannelStatsPanel().down('#ChannelStatsChartPanel');",
                    "MyApp.app.channStats.panelGridStats=this.getChannelStatsPanel().down('#ChannelStatsGrid');",
                    "MyApp.app.channStats.gridStats=Ext.ComponentQuery.query('#ChannelStatsGrid')[0];",
                    "MyApp.app.channStats.chartStats=null;",
                    "",
                    "MyApp.app.channStats.panelChartHistogram=this.getChannelStatsPanel().down('#ChannelStatsChartHistogram');",
                    "MyApp.app.channStats.chartHistogram=null;",
                    "MyApp.app.channStats.histogramData=null;",
                    "",
                    "//MyApp.app.channStats.panelChartHistogramRelative=this.getChannelStatsPanel().down('#ChannelStatsChartHistogramRelative');",
                    "//MyApp.app.channStats.chartHistogramRelative=null;",
                    "//MyApp.app.channStats.histogramRelativeData=null;",
                    "",
                    "",
                    "//this.getChannelStatsPanel().items.items[0].setActiveTab(2);",
                    "this.getChannelStatsPanel().items.items[0].setActiveTab(1);",
                    "this.getChannelStatsPanel().items.items[0].setActiveTab(0);",
                    "",
                    "this.loadStatsData(MyApp.app.channStats);",
                    "this.loadHistogramData(MyApp.app.channStats);",
                    "//this.loadHistogramRelativeData(MyApp.app.channStats);",
                    ""
                ]
            },
            "designerId": "3ae33637-7e09-45b6-9557-d90edb139222"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "module"
                ],
                "fn": "loadStatsData",
                "implHandler": [
                    "module.panelChartStats.setLoading(true);",
                    "module.gridStats.store.load({",
                    "    url:'/nmdadb/channel/stats/default/default',",
                    "    callback: function(records, operation, success) {",
                    "        this.initStatsChart(MyApp.app.channStats);",
                    "        module.panelChartStats.setLoading(false);",
                    "    },",
                    "    scope: this",
                    "});",
                    ""
                ]
            },
            "designerId": "1c74560d-c60d-4d1e-98e2-d51a0d4dfcca"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "module"
                ],
                "fn": "loadHistogramData",
                "implHandler": [
                    "module.panelChartHistogram.setLoading(true);",
                    "",
                    "Ext.Ajax.request({",
                    "    url: 'http://localhost:8080/nmdadb/channel/histogram/default/default',",
                    "    success: function(response){",
                    "        var text = response.responseText;",
                    "        data=Ext.JSON.decode(text);",
                    "        /*for (i = 0; i < data.length; i++) {",
                    "            data[i].push(data[i][data[i].length-1]);",
                    "        }*/",
                    "        module.histogramData=data;",
                    "        this.initHistogramChart(module);",
                    "        module.panelChartHistogram.setLoading(false);",
                    "    },",
                    "    scope: this",
                    "});"
                ]
            },
            "designerId": "85f50e3c-a8bf-4348-83ce-f2ae9f916646"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "module"
                ],
                "fn": "loadHistogramRelativeData",
                "implHandler": [
                    "module.panelChartHistogramRelative.setLoading(true);",
                    "",
                    "Ext.Ajax.request({",
                    "    url: 'http://localhost:8080/nmdadb/channel/histogramRelative/default/default',",
                    "    success: function(response){",
                    "        var text = response.responseText;",
                    "        data=Ext.JSON.decode(text);",
                    "        //",
                    "        for (i = 0; i < data.length; i++) {",
                    "            data[i].push(data[i][data[i].length-1]);",
                    "        }",
                    "        module.histogramRelativeData=data;",
                    "        this.initHistogramRelativeChart(module);",
                    "        module.panelChartHistogramRelative.setLoading(false);",
                    "    },",
                    "    scope: this",
                    "});"
                ]
            },
            "designerId": "82db25ee-7a96-430e-bdd6-5bc1fefb41cb"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "module"
                ],
                "fn": "initStatsChart",
                "implHandler": [
                    "var dataOHLC=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];",
                    "var line=[];",
                    "",
                    "var data=module.gridStats.store.data;",
                    "",
                    "for (var i=0;i<data.length;i++){",
                    "    line[i]=data.items[i].data.average;",
                    "    dataOHLC[i][0]=data.items[i].data.average+data.items[i].data.std;",
                    "    dataOHLC[i][1]=data.items[i].data.max;",
                    "    dataOHLC[i][2]=data.items[i].data.min;",
                    "    dataOHLC[i][3]=data.items[i].data.average-data.items[i].data.std;",
                    "",
                    "}",
                    "module.chartStats = new Highcharts.Chart({",
                    "    chart: {",
                    "        renderTo: module.panelChartStats.getEl().dom",
                    "    },",
                    "    title: {",
                    "",
                    "    },",
                    "    legend : {",
                    "        enabled: true",
                    "    },",
                    "    scrollbar:{",
                    "        enabled: false",
                    "    },",
                    "    navigator:{",
                    "        enabled: false",
                    "    },",
                    "    rangeSelector: {",
                    "        buttons: [],",
                    "        inputEnabled: false",
                    "    },",
                    "    yAxis:[{",
                    "        title: {",
                    "            text: 'Values'",
                    "        },",
                    "        minRange: 0.001,",
                    "        opposite: false,",
                    "        labels:{",
                    "            x:10",
                    "        },",
                    "        min:0",
                    "    }],",
                    "    xAxis:{",
                    "        categories:['ch01','ch02','ch03','ch04','ch05','ch06','ch07','ch08','ch09','ch10','ch11','ch12','ch13','ch14','ch15','ch16','ch17','ch18']",
                    "    },",
                    "    series:  [{",
                    "        name : 'OHLC',\t\t\t\t//0",
                    "        type : 'candlestick',",
                    "        data : dataOHLC,",
                    "        dataGrouping: {",
                    "            enabled: false",
                    "        }",
                    "    },{",
                    "        name : 'Average Line',\t\t\t\t//1",
                    "        type : 'line',",
                    "        data : line,",
                    "        dataGrouping: {",
                    "            enabled: false",
                    "        }",
                    "    }]",
                    "});"
                ]
            },
            "designerId": "da6a3fc1-122e-49c6-afa6-5b903b6e4ba6"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "module"
                ],
                "fn": "initHistogramChart",
                "implHandler": [
                    "module.chartHistogram= new Highcharts.StockChart({",
                    "    chart: {",
                    "        renderTo: module.panelChartHistogram.getEl().dom,",
                    "        zoomType: 'x'",
                    "    },",
                    "    xAxis: {labels: {   formatter: function () {return this.value*5;}}",
                    "",
                    "    },",
                    "    tooltip:{enabled: false},",
                    "    yAxis:{",
                    "        min: 0,",
                    "        minRange: 0.001,",
                    "        labels: {",
                    "                format: '{value}%'",
                    "        }",
                    "    },",
                    "    legend : {",
                    "        enabled: true",
                    "    },",
                    "    scrollbar:{",
                    "        enabled: true",
                    "    },",
                    "    navigator:{",
                    "        enabled: false",
                    "    },",
                    "    rangeSelector: {",
                    "                buttons: [{",
                    "                    type: 'all',",
                    "                    text: 'All'",
                    "                }],",
                    "                selected: 0,",
                    "\t\t\t\tinputEnabled: false",
                    "            },",
                    "    series: [{",
                    "        name: 'ch01',",
                    "        data: module.histogramData[0],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch02',",
                    "        data:  module.histogramData[1],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch03',",
                    "        data:  module.histogramData[2],",
                    "        step: true,",
                    "        visible: false",
                    "    },{",
                    "        name: 'ch04',",
                    "        data:  module.histogramData[3],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch05',",
                    "        data:  module.histogramData[4],",
                    "        step: true,",
                    "        visible: false",
                    "    },{",
                    "        name: 'ch06',",
                    "        data:  module.histogramData[5],",
                    "        step: true,",
                    "        visible: false",
                    "    },{",
                    "        name: 'ch07',",
                    "        data:  module.histogramData[6],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch08',",
                    "        data:  module.histogramData[7],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch09',",
                    "        data:  module.histogramData[8],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch10',",
                    "        data:  module.histogramData[9],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch11',",
                    "        data:  module.histogramData[10],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch12',",
                    "        data:  module.histogramData[11],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch013',",
                    "        data:  module.histogramData[12],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch14',",
                    "        data:  module.histogramData[13],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch15',",
                    "        data:  module.histogramData[14],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch16',",
                    "        data:  module.histogramData[15],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch17',",
                    "        data:  module.histogramData[16],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch18',",
                    "        data:  module.histogramData[17],",
                    "        step: true",
                    "    }]",
                    "});"
                ]
            },
            "designerId": "49b64747-7d83-4cfe-9b8d-bf097b754c2e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "module"
                ],
                "fn": "initHistogramRelativeChart",
                "implHandler": [
                    "/**",
                    "     * Highcharts plugin for setting a lower opacity for other series than the one that is hovered",
                    "     * in the legend",
                    "     */",
                    "",
                    "var each = Highcharts.each;",
                    "",
                    "Highcharts.wrap(Highcharts.Legend.prototype, 'renderItem', function (proceed, item) {",
                    "",
                    "    proceed.call(this, item);",
                    "",
                    "",
                    "    var isPoint = !!item.series,",
                    "        collection = isPoint ? item.series.points : this.chart.series,",
                    "        groups = isPoint ? ['graphic'] : ['group', 'markerGroup'],",
                    "        element = item.legendGroup.element;",
                    "",
                    "    element.onmouseover = function () {",
                    "        each(collection, function (seriesItem) {",
                    "            if (seriesItem !== item) {",
                    "                each(groups, function (group) {",
                    "                    seriesItem[group].animate({",
                    "                        opacity: 0.0",
                    "                    }, {",
                    "                        duration: 150",
                    "                    });",
                    "                });",
                    "            }",
                    "        });",
                    "    };",
                    "    element.onmouseout = function () {",
                    "        each(collection, function (seriesItem) {",
                    "            if (seriesItem !== item) {",
                    "                each(groups, function (group) {",
                    "                    seriesItem[group].animate({",
                    "                        opacity: 1",
                    "                    }, {",
                    "                        duration: 50",
                    "                    });",
                    "                });",
                    "            }",
                    "        });",
                    "    };",
                    "",
                    "});",
                    "",
                    "",
                    "module.chartHistogramRelative= new Highcharts.StockChart({",
                    "    chart: {",
                    "        renderTo: module.panelChartHistogramRelative.getEl().dom",
                    "    },",
                    "    xAxis: {labels: {   formatter: function () {return (this.value-40)*5;}}",
                    "",
                    "    },",
                    "    tooltip:{enabled: false},",
                    "    yAxis:{",
                    "        min: 0,",
                    "        minRange: 0.001,",
                    "        labels: {",
                    "                format: '{value}%'",
                    "        }",
                    "    },",
                    "    legend : {",
                    "        enabled: true",
                    "    },",
                    "    scrollbar:{",
                    "        enabled: false",
                    "    },",
                    "    navigator:{",
                    "        enabled: false",
                    "    },",
                    "    rangeSelector: {",
                    "        buttons: [],",
                    "        inputEnabled: false",
                    "    },",
                    "    series: [{",
                    "        name: 'ch01',",
                    "        data: module.histogramRelativeData[0],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch02',",
                    "        data:  module.histogramRelativeData[1],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch03',",
                    "        data:  module.histogramRelativeData[2],",
                    "        step: true,",
                    "        visible: false",
                    "    },{",
                    "        name: 'ch04',",
                    "        data:  module.histogramRelativeData[3],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch05',",
                    "        data:  module.histogramRelativeData[4],",
                    "        step: true,",
                    "        visible: false",
                    "    },{",
                    "        name: 'ch06',",
                    "        data:  module.histogramRelativeData[5],",
                    "        step: true,",
                    "        visible: false",
                    "    },{",
                    "        name: 'ch07',",
                    "        data:  module.histogramRelativeData[6],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch08',",
                    "        data:  module.histogramRelativeData[7],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch09',",
                    "        data:  module.histogramRelativeData[8],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch10',",
                    "        data:  module.histogramRelativeData[9],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch11',",
                    "        data:  module.histogramRelativeData[10],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch12',",
                    "        data:  module.histogramRelativeData[11],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch013',",
                    "        data:  module.histogramRelativeData[12],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch14',",
                    "        data:  module.histogramRelativeData[13],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch15',",
                    "        data:  module.histogramRelativeData[14],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch16',",
                    "        data:  module.histogramRelativeData[15],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch17',",
                    "        data:  module.histogramRelativeData[16],",
                    "        step: true",
                    "    },{",
                    "        name: 'ch18',",
                    "        data:  module.histogramRelativeData[17],",
                    "        step: true",
                    "    }]",
                    "});"
                ]
            },
            "designerId": "d74aab3e-822a-4b4d-92aa-698192160e58"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "start, finish, module"
                ],
                "fn": "searchInterval",
                "implHandler": [
                    "start=Math.floor(MyApp.app.getController(\"Spike\").getTimestamp(start)/1000);",
                    "finish=Math.floor(MyApp.app.getController(\"Spike\").getTimestamp(finish)/1000);",
                    "",
                    "if(finish-start >= 60*60*24*32){",
                    "    alert('Maximum of one month');",
                    "    return;",
                    "}",
                    "",
                    "if (start >= finish){",
                    "    alert('Bad interval...');",
                    "    return;",
                    "}",
                    "",
                    "var my_url='/nmdadb/channel/stats/'+start+'/'+finish;",
                    "",
                    "module.gridStats.store.load({",
                    "    url: my_url,",
                    "    callback: function(records, operation, success) {",
                    "        var dataOHLC=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];",
                    "        var line=[];",
                    "        for (var i=0;i<records.length;i++){",
                    "            line[i]=records[i].data.average;",
                    "            dataOHLC[i][0]=records[i].data.average+records[i].data.std;",
                    "            dataOHLC[i][1]=records[i].data.max;",
                    "            dataOHLC[i][2]=records[i].data.min;",
                    "            dataOHLC[i][3]=records[i].data.average-records[i].data.std;",
                    "",
                    "        }",
                    "        module.chartStats.series[0].setData(dataOHLC);",
                    "        module.chartStats.series[1].setData(line);",
                    "    },",
                    "    scope: this",
                    "});",
                    "",
                    "",
                    "var my_url='/nmdadb/channel/histogram/'+start+'/'+finish;",
                    "module.panelChartHistogram.setLoading(true);",
                    "Ext.Ajax.request({",
                    "    url: my_url,",
                    "    success: function(response){",
                    "        var text = response.responseText;",
                    "        data=Ext.JSON.decode(text);",
                    "        for (i = 0; i < data.length; i++) {",
                    "            module.chartHistogram.series[i].setData(data[i]);",
                    "        }",
                    "        module.histogramData=data;",
                    "        module.panelChartHistogram.setLoading(false);",
                    "    },",
                    "    scope: this",
                    "});",
                    "",
                    "/*",
                    "var my_url='/nmdadb/channel/histogramRelative/'+start+'/'+finish;",
                    "module.panelChartHistogramRelative.setLoading(true);",
                    "Ext.Ajax.request({",
                    "    url: my_url,",
                    "    success: function(response){",
                    "        var text = response.responseText;",
                    "        data=Ext.JSON.decode(text);",
                    "        for (i = 0; i < data.length; i++) {",
                    "            data[i].push(data[i][data[i].length-1]);",
                    "            module.chartHistogramRelative.series[i].setData(data[i]);",
                    "        }",
                    "        module.histogramRelativeData=data;",
                    "        module.panelChartHistogramRelative.setLoading(false);",
                    "    },",
                    "    scope: this",
                    "});",
                    "*/"
                ]
            },
            "designerId": "75118154-2ae5-42ac-8b82-8abb7a5e0aab"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showChannStats",
                "implHandler": [
                    "this.getNavigationPanel().getLayout().setActiveItem(this.getChannelStatsPanel());",
                    "Ext.ComponentQuery.query('#Controls')[0].down('#ChannelStatsControls').expand();",
                    "if(!MyApp.app.channStats)",
                    "    MyApp.app.getController(\"ChannelStats\").Launch();"
                ]
            },
            "designerId": "5cac0fc6-b6e9-448c-aa58-682090513d3f"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "ChannelStatsPanel",
                "selector": "#ChannelStatsPanel"
            },
            "designerId": "9d791695-69ce-4d56-b97e-3b0b2295d4ee"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "navigationPanel",
                "selector": "#NavigationPanel"
            },
            "designerId": "bee6ff38-1d3d-48eb-b140-eadf2819af9f"
        }
    ]
}